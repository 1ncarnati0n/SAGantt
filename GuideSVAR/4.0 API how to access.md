# How to access Gantt API

출처: https://docs.svar.dev/react/gantt/api/how_to_access_api

## 개요

Gantt `API`에 접근하기 위해 아래의 두 가지 방법 중 하나를 사용할 수 있습니다:

- `init` `handler` 함수를 파라미터로서 `api`와 함께 적용하기
- `apiRef` 속성과 함께 `useRef`를 사용하기

---

## `Apply the init handler`

`init` `handler` 함수를 사용하여 Gantt `API`에 접근할 수 있으며, 이는 파라미터로서 `api`를 받습니다.

아래의 예제는 `init` 함수를 사용하는 방법과 `zoom-scale` 액션을 `api.on()` 메서드의 도움으로 리스닝하면서 콘솔에 현재 `zoom` 레벨을 출력하고 `api.getState()` 메서드를 통해 `zoom` 레벨의 상태를 얻는 방법을 보여줍니다.

### 예제

```javascript
import { useEffect, useRef } from "react";
import { getData } from "../data";
import { Gantt } from "wx-react-gantt";
import "wx-react-gantt/dist/gantt.css";

const data = getData();

function App() {
  const apiRef = useRef(null);

  useEffect(() => {
    if (apiRef.current) {
      apiRef.current.on("zoom-scale", () => {
        console.log("The current zoom level is", apiRef.current.getState().zoom);
      });
    }
  }, [apiRef.current]);

  return (
    <>
      <h4>Point over Gantt chart, then hold Ctrl and use mouse wheel to zoom</h4>
      <Gantt 
        init={(api) => (apiRef.current = api)} 
        tasks={data.tasks} 
        links={data.links} 
        zoom 
      />
    </>
  );
}

export default App;
```

---

## `Bind to api`

`api` `gateway` 객체를 통해 Gantt `API`에 접근할 수 있습니다. `api` 객체에 대한 참조를 가져오기 위해 `apiRef` 속성을 사용해야 합니다.

아래의 예제에서 우리는 `bind: apiRef`를 통해 Gantt `api`에 접근하고 Gantt `api`를 유지하는 `api` 변수를 `Toolbar`에 전달합니다:

### 예제

```javascript
import { getData } from "./common/data";
import { Gantt, Toolbar } from "wx-react-gantt";
import "wx-react-gantt/dist/gantt.css";
import { useRef } from "react";

function App() {
  const data = getData();
  const apiRef = useRef();

  return (
    <>
      <Toolbar api={apiRef.current} />
      <Gantt apiRef={apiRef} tasks={data.tasks} />
    </>
  );
}

export default App;
```

---

## `API Methods` 목록

다음은 사용 가능한 `API` 메서드들입니다:

| 메서드 | 설명 |
|--------|------|
| `api.detach()` | `API`에서 리스너를 제거합니다 |
| `api.exec()` | 특정 액션을 실행합니다 |
| `api.getReactiveState()` | 반응형 상태를 가져옵니다 |
| `api.getState()` | 현재 상태를 가져옵니다 |
| `api.getStores()` | `stores`를 가져옵니다 |
| `api.getTask(id)` | 특정 ID의 작업을 가져옵니다 |
| `api.intercept()` | 액션을 가로채고 수정합니다 |
| `api.on()` | 이벤트 리스너를 등록합니다 |
| `api.setNext()` | 다음 상태를 설정합니다 |

각 메서드에 대한 상세 설명은 다음 섹션에서 확인할 수 있습니다.

---

## 두 가지 접근 방식의 비교

### `init` 핸들러 방식

**사용법:**
```javascript
<Gantt 
  init={(api) => {
    // API 사용
  }}
  tasks={data.tasks}
/>
```

**장점:**
- 직접적인 `API` 접근
- `Gantt` 초기화 시점에 즉시 `API` 접근 가능

**단점:**
- 다른 컴포넌트에서 접근하기 어려움
- `closure` 문제 가능성

### `useRef`와 `apiRef` 방식

**사용법:**
```javascript
const apiRef = useRef();

<Gantt apiRef={apiRef} tasks={data.tasks} />

// 다른 곳에서 접근
<Toolbar api={apiRef.current} />
```

**장점:**
- 여러 컴포넌트에서 공유 가능
- 더 유연한 구조
- React의 표준 패턴

**단점:**
- `useEffect` 내에서만 안전하게 사용 가능
- `null` 체크 필요

---

## 권장 사항

**`init` 핸들러를 사용할 때:**
- 간단한 단일 컴포넌트 구조
- `API`를 초기화 시점에만 설정하면 되는 경우

**`useRef`를 사용할 때:**
- 복잡한 다중 컴포넌트 구조
- `Toolbar`, `ContextMenu` 등 외부 컴포넌트와 연동이 필요한 경우
- `API`에 자주 접근해야 하는 경우

